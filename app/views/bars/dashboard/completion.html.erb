<script>
  function countChar(val){
    var len = val.value.length;
    if (len >= 500) {
      val.value = val.value.substring(0, 500);
    }else {
      $('#charNum').text(len);
    }
  };
</script>
<script type="text/javascript">
  var available_tags = [];
<% SportTeam.all.each do |team| %>
    available_tags.push('<%= team.team_name %>');
<% end %>
  $("#mytags").tagit({tagSource: available_tags, allowSpaces: true});
</script>
<script type="text/javascript">
  function validate_address(){
    if($('#bar_address').val() == ''){
      $('#bar_address').css('border', '1px solid red');
      valid_address = false;
    }else{
      $('#bar_address').css('border', '1px solid black');
      valid_address = true;
    }
    if($('#bar_city').val() == ''){
      $('#bar_city').css('border', '1px solid red');
      valid_city = false;
    }else{
      $('#bar_city').css('border', '1px solid black');
      valid_city = true;
    }
    if($('#bar_zip_code').val() == ''){
      $('#bar_zip_code').css('border', '1px solid red');
      valid_zip = false;
    }else{
      $('#bar_zip_code').css('border', '1px solid black');
      valid_zip = true;
    }
    if(valid_address && valid_city && valid_zip){
      $('#goto_phone').click();
    }
  }
  function validate_phone(){
    if($('#bar_phone_number').val() == ''){
      $('#bar_phone_number').css('border', '1px solid red');
      valid_phone = false;
    }else{
      $('#bar_phone_number').css('border', '1px solid black');
      valid_phone = true;
    }
    if(valid_phone){
      $('#goto_link').click();
    }
  }
  function validate_link(){
    if($('#bar_website_link').val() == ''){
      $('#bar_website_link').css('border', '1px solid red');
      valid_web = false;
    }else{
      $('#bar_website_link').css('border', '1px solid black');
      valid_web = true;
    }
    if($('#bar_facebook_link').val() == ''){
      $('#bar_facebook_link').css('border', '1px solid red');
      valid_facebook = false;
    }else{
      $('#bar_facebook_link').css('border', '1px solid black');
      valid_facebook = true;
    }
    if($('#bar_twitter_link').val() == ''){
      $('#bar_twitter_link').css('border', '1px solid red');
      valid_twitter = false;
    }else{
      $('#bar_twitter_link').css('border', '1px solid black');
      valid_twitter = true;
    }
    if($('#bar_google_plus_link').val() == ''){
      $('#bar_google_plus_link').css('border', '1px solid red');
      valid_google = false;
    }else{
      $('#bar_google_plus_link').css('border', '1px solid black');
      valid_google = true;
    }
    if(valid_web && valid_facebook && valid_twitter && valid_google){
      $('#goto_hour').click();
    }
  }
  function validate_hour(){
    if($('#bar_bar_hour').val() == ''){
      $('#bar_bar_hour').css('border', '1px solid red');
      valid_hour = false;
    }else{
      $('#bar_bar_hour').css('border', '1px solid black');
      valid_hour = true;
    }
    if(valid_hour){
      $('#goto_description').click();
    }
  }
  function validate_description(){
    if($('#bar_bar_description').val() == ''){
      $('#bar_bar_description').css('border', '1px solid red');
      valid_description = false;
    }else{
      $('#bar_bar_description').css('border', '1px solid black');
      valid_description= true;
    }
    if(valid_description){
      $('#goto_sport_team').click();
    }
  }
  function validate_sports_team(){
    if($('#mytags').val() == ''){
      $('#mytags').css('border', '1px solid red');
      valid_description = false;
    }else{
      $('#mytags').css('border', '1px solid black');
      valid_description = true;
    }
    if(valid_description){
      $('#goto_check_data').click();
      get_all_data();
    }
  }
  $('#goto_check_data').click();
  get_all_data();

  function get_all_data(){
    $('#address_text').html($('#bar_address').val());
    $('#city_text').html($('#bar_city').val());
    $('#zip_text').html($('#bar_zip_code').val());
    $('#phone_text').html($('#bar_phone_number').val());
    $('#website_text').html($('#bar_website_link').val());
    $('#facebook_text').html($('#bar_facebook_link').val());
    $('#twitter_text').html($('#bar_twitter_link').val());
    $('#google_text').html($('#bar_google_plus_link').val());
    $('#hour_text').html($('#bar_bar_hour').val());
    $('#description_text').html($('#bar_bar_description').val());
    $('#sport_text').html($('#mytags').val());
  }

  

  //var name_element = document.getElementById('bar_address');
  //var name_element = document.getElementById('bar_address');
  //var name_element = document.getElementById('bar_address');

  $(document).ready(function(){
    $('#completion_link').click();
  })
</script>
<style type="text/css">
  .modal{
    width: 600px!important;
    overflow: hidden!important;
  }
</style>

<h4>Please Complete your bar profile!</h4>

click <a href="#ask" data-toggle="modal" id="completion_link">here</a> to complete

<%= content_for :outer do %>
  <div id="ask" class="modal hide fade">
    <div class="modal-header">
      <a class="close" data-dismiss="modal"><b>x</b></a>
      <h3 style="text-align: center;">Profile Verification </h3>
    </div>
    <div class="modal-body">
      <div style="text-align: center;">
        <b>Your Bar Profile not Complete Yet, Would you like to complete now?</b>
      </div>
      <div style="text-align: center;">
        <a href="#location" data-toggle="modal" data-dismiss="modal" class="btn" >Yes</a>
        <%= link_to "No", root_path, class: "btn" %>
        </div>
      </div>
      <div class="modal-footer">
      </div>
    </div>
    <%= simple_form_for(@bar, url: bars_update_completion_path, method: :get, :html => {multipart: true , class: "form-horizontal"}) do |f| %>
        <div id="location" class="modal hide fade">
          <div class="modal-header">
            <a class="close" data-dismiss="modal"><b>x</b></a>
            <h3 style="text-align: center;">Where is the <%= @bar.name %> located?</h3>
          </div>
          <div class="modal-body">
            <%= f.input :address, :hint => "Ex : 67 Clinton Street" %>
            <%= f.input :city, as: :select, collection: avaliable_cities %>
            <%= f.input :zip_code %>
          </div>
          <div class="modal-footer">
            <a class="btn" onclick="return validate_address()">Continue</a>
            <a href="#phone" data-toggle="modal" data-dismiss="modal" class="btn" id="goto_phone" style="display:none;">Continue</a>
          </div>
        </div>
        <div id="phone" class="modal hide fade">
          <div class="modal-header">
            <a class="close" data-dismiss="modal"><b>x</b></a>
            <h3 style="text-align: center;">How do people get in touch with <%= @bar.name %>?</h3>
          </div>
          <div class="modal-body">
            <%= f.input :phone_number %>
          </div>
          <div class="modal-footer">
            <a class="btn" onclick="return validate_phone()">Continue</a>
            <a href="#link" data-toggle="modal" data-dismiss="modal" class="btn" id="goto_link" style="display: none;">Continue</a>
            <a href="#location" data-toggle="modal" data-dismiss="modal" class="btn">Back</a>
          </div>
        </div>
        <div id="link" class="modal hide fade">
          <div class="modal-header">
            <a class="close" data-dismiss="modal"><b>x</b></a>
            <h3 style="text-align: center;">How can people connect with <%= @bar.name %>?</h3>
          </div>
          <div class="modal-body">
            <%= f.input :website_link %>
            <%= f.input :facebook_link %>
            <%= f.input :twitter_link %>
            <%= f.input :google_plus_link %>
          </div>
          <div class="modal-footer">
            <!--<a class="btn" onclick="return validate_link()">Continue</a>-->
            <a class="btn" href="#hour" data-dismiss="modal" data-toggle="modal" id="goto_hour" >Continue</a>
            <a class="btn" href="#phone" data-dismiss="modal" data-toggle="modal">Back</a>
          </div>
        </div>
        <div id="hour" class="modal hide fade">
          <div class="modal-header">
            <a class="close" data-dismiss="modal"><b>x</b></a>
            <h3 style="text-align: center;">“What is <%= @bar.name %> hours?”</h3>
          </div>
          <div class="modal-body">
            <%= f.fields_for :bar_hours do |ff| %>
              <div class="span2" style="margin-right: 10px;">
                <b><%= ff.object.day %></b>
                <%= ff.input :open_hour, as: :select, label: false, collection: 1..24, input_html: {style: "width: 45px;margin-left: -160px;"} %>
                <%= ff.input :close, as: :select, label: false, collection: 1..24, input_html: {style: "width: 45px;margin-left: -160px;"} %>

              </div>
            <% end %>
          </div>
          <div class="modal-footer">
            <a class="btn" onclick="return validate_hour()">Continue</a>
            <a class="btn" href="#description" data-dismiss="modal" data-toggle="modal" id="goto_description" style="display: none;">Continue</a>
            <a class="btn" href="#link" data-dismiss="modal" data-toggle="modal">Back</a>
          </div>
        </div>
        <div id="description" class="modal hide fade">
          <div class="modal-header">
            <a class="close" data-dismiss="modal"><b>x</b></a>
            <h3 style="text-align: center;">What do you want people to know about <%= @bar.name %>?</h3>
          </div>
          <div class="modal-body">
            <div style="margin-left: -50px;">
              <%= f.input :bar_description, label: false, placeholder: "Bar Description...", input_html: {style: "width: 400px;height: 200px;margin-left: -30px;", onkeyup: "countChar(this)"} %>
              <div class="pull-right" id="charNum"></div>
            </div>
          </div>
          <div class="modal-footer">
            <a class="btn" onclick="return validate_description()">Continue</a>
            <a class="btn" href="#sport_team" data-dismiss="modal" data-toggle="modal" id="goto_sport_team" style="display: none;">Continue</a>
            <a class="btn" href="#hour" data-dismiss="modal" data-toggle="modal">Back</a>
          </div>
        </div>
        <div id="sport_team" class="modal hide fade">
          <div class="modal-header">
            <a class="close" data-dismiss="modal"><b>x</b></a>
            <h3 style="text-align: center;">What Sports Teams does <%= @bar.name %> support?</h3>
          </div>
          <div class="modal-body">
            <%= f.input :sports_team, label: false, placeholder: "Sports Team" ,input_html: {id: "mytags", multiple: true,  style: "width:250px"}%>
          </div>
          <div class="modal-footer">
            <!--<a class="btn" onclick="return validate_sports_team();">Continue</a>-->
            <a class="btn" href="#check_data" data-dismiss="modal" data-toggle="modal" onclick="return get_all_data();" >Continue</a>
            <a class="btn" href="#description" data-dismiss="modal" data-toggle="modal">Back</a>
          </div>
        </div>
        <div id="check_data" class="modal hide fade">
          <div class="modal-header">
            <a class="close" data-dismiss="modal"><b>x</b></a>
            <h3 style="text-align: center;">Did we get it all?</h3>
          </div>
          <div class="modal-body">
            <table style="border-style: none;">
              <tr>
                <td>Address : </td>
                <td><div id="address_text"></div></td>
                <td>City : </td>
                <td><div id="city_text"></div></td>
              </tr>
              <tr>
                <td>Zip Code : </td>
                <td><div id="zip_text"></div></td>
                <td>Phone : </td>
                <td><div id="phone_text"></div></td>
              </tr>
              <tr>
                <td>Website link: </td>
                <td><div id="website_text"></div></td>
                <td>Facebook link: </td>
                <td><div id="facebook_text"></div></td>
              </tr>
              <tr>
                <td>Twitter link: </td>
                <td><div  id="twitter_text"></div></td>
                <td>Google Plus link: </td>
                <td><div  id="google_text"></div></td>
              </tr>
              <tr>
                <td>Hour : </td>
                <td><div  id="hour_text"></div></td>
                <td>Description : </td>
                <td><div  id="description_text"></div></td>
              </tr>
              <tr>
                <td>Sport Team : </td>
                <td><div  id="sport_text"></div></td>
                <td></td>
                <td></td>
              </tr>
            </table>

          </div>
          <div class="modal-footer">
            <a class="btn" data-dismiss="modal" data-toggle="modal">Cancel</a>
            <a class="btn" href="#sport_team" data-dismiss="modal" data-toggle="modal">Back</a>
            <%= f.submit "Submit", class: "btn-primary" %>
            </div>
          </div>
        <% end %>
      <% end %>
